<main>
    <mat-card>
        <mat-card-header>Property</mat-card-header>

        <div>
            <mat-form-field appearance="standard">
                <mat-label>Property Cost</mat-label>
                <input matInput [(ngModel)]="inversion.propertyCost" required appThousands />
            </mat-form-field>
        </div>

        <div>
            <mat-form-field appearance="standard">
                <mat-label>Total Additional Cost</mat-label>
                <input matInput readonly [ngModel]="inversion.additionalCosts.total" />
            </mat-form-field>
        </div>

        <mat-expansion-panel>
            <mat-expansion-panel-header>Additional Cost</mat-expansion-panel-header>

            <mat-card>
                <mat-card-header>Financing Expenses</mat-card-header>

                <div>
                    <mat-form-field appearance="standard">
                        <mat-label>Taxes & Fees (%)</mat-label>
                        <input matInput [(ngModel)]="inversion.additionalCosts.financTaxes" percentage />
                    </mat-form-field>

                    <mat-form-field appearance="standard">
                        <mat-label>Total</mat-label>
                        <input matInput readonly [ngModel]="inversion.additionalCosts.financTaxesTotal" />
                    </mat-form-field>
                </div>

                <div>
                    <mat-form-field appearance="standard">
                        <mat-label>Appraisal</mat-label>
                        <input matInput [(ngModel)]="inversion.additionalCosts.appraisal" />
                    </mat-form-field>

                    <mat-form-field appearance="standard">
                        <mat-label>Total</mat-label>
                        <input matInput readonly [ngModel]="inversion.additionalCosts.appraisalTotal" />
                    </mat-form-field>
                </div>


                <div>
                    <mat-form-field appearance="standard">
                        <mat-label>Mortgage Fees (%)</mat-label>
                        <input matInput [(ngModel)]="inversion.additionalCosts.mortgageFees" percentage />
                    </mat-form-field>

                    <mat-form-field appearance="standard">
                        <mat-label>Total</mat-label>
                        <input matInput readonly
                            [ngModel]="inversion.additionalCosts.mortgageFeesTotal  | number:'1.0-0'" />
                    </mat-form-field>
                </div>

                <mat-card-footer>
                    <label class="total-label">Total</label>
                    <label>{{inversion.additionalCosts.financTotal  | number:'1.0-0'}}</label>
                </mat-card-footer>
            </mat-card>

            <mat-card>
                <mat-card-header>Additional Costs</mat-card-header>

                <div>
                    <mat-form-field appearance="standard">
                        <mat-label>Purchase Tax (%)</mat-label>
                        <input matInput [(ngModel)]="inversion.additionalCosts.purchaseTax" percentage />
                    </mat-form-field>

                    <mat-form-field appearance="standard">
                        <mat-label>Total</mat-label>
                        <input matInput readonly [ngModel]="inversion.additionalCosts.purchaseTaxTotal" />
                    </mat-form-field>
                </div>

                <div>
                    <mat-form-field appearance="standard">
                        <mat-label>Due Diligens Reports (%)</mat-label>
                        <input matInput [(ngModel)]="inversion.additionalCosts.diligensReports" percentage />
                    </mat-form-field>

                    <mat-form-field appearance="standard">
                        <mat-label>Total</mat-label>
                        <input matInput readonly [ngModel]="inversion.additionalCosts.diligensReportsTotal" />
                    </mat-form-field>
                </div>

                <div>
                    <mat-form-field appearance="standard">
                        <mat-label>Notary & Property Registration (%)</mat-label>
                        <input matInput [(ngModel)]="inversion.additionalCosts.notary" percentage />
                    </mat-form-field>

                    <mat-form-field appearance="standard">
                        <mat-label>Total</mat-label>
                        <input matInput readonly [ngModel]="inversion.additionalCosts.notaryTotal" />
                    </mat-form-field>
                </div>

                <div>
                    <mat-form-field appearance="standard">
                        <mat-label>Tourist Use Permission</mat-label>
                        <input matInput [(ngModel)]="inversion.additionalCosts.touristUsePermission" />
                    </mat-form-field>

                    <mat-form-field appearance="standard">
                        <mat-label>Total</mat-label>
                        <input matInput readonly [ngModel]="inversion.additionalCosts.touristUsePermissionTotal" />
                    </mat-form-field>
                </div>

                <div>
                    <mat-form-field appearance="standard">
                        <mat-label>Legal Fees (Lawyers) (%)</mat-label>
                        <input matInput [(ngModel)]="inversion.additionalCosts.lawyers" percentage />
                    </mat-form-field>

                    <mat-form-field appearance="standard">
                        <mat-label>Total (+300)</mat-label>
                        <input matInput readonly [ngModel]="inversion.additionalCosts.lawyersTotal" />
                    </mat-form-field>
                </div>

                <div>
                    <mat-form-field appearance="standard">
                        <mat-label>Legal (miscelaneous)</mat-label>
                        <input matInput [(ngModel)]="inversion.additionalCosts.legal" />
                    </mat-form-field>

                </div>

                <div>
                    <mat-form-field appearance="standard">
                        <mat-label>Process Fees (REJ & GB) (%)</mat-label>
                        <input matInput [(ngModel)]="inversion.additionalCosts.REJFees" percentage />
                    </mat-form-field>

                    <mat-form-field appearance="standard">
                        <mat-label>Total</mat-label>
                        <input matInput readonly [ngModel]="inversion.additionalCosts.REJFeesTotal" />
                    </mat-form-field>
                </div>

                <mat-card-footer>
                    <label class="total-label">Total</label>
                    <label>{{inversion.additionalCosts.additionalTotal  | number:'1.0-0'}}</label>
                </mat-card-footer>
            </mat-card>

            <mat-card>
                <mat-card-header>Renovation Costs (Est.)</mat-card-header>

                <div>
                    <mat-form-field appearance="standard">
                        <mat-label>Property Size</mat-label>
                        <input matInput [(ngModel)]="inversion.additionalCosts.propertySize" />
                    </mat-form-field>

                </div>
                <div>
                    <mat-form-field appearance="standard">
                        <mat-label>Cost per Sq.M</mat-label>
                        <input matInput [(ngModel)]="inversion.additionalCosts.renovationCostPerM" />
                    </mat-form-field>


                    <mat-form-field appearance="standard">
                        <mat-label>Total</mat-label>
                        <input matInput readonly [ngModel]="inversion.additionalCosts.renovationCostPropertyTotal" />
                    </mat-form-field>
                </div>

                <div>
                    <mat-form-field appearance="standard">
                        <mat-label>Accessories & Appliances</mat-label>
                        <input matInput [(ngModel)]="inversion.additionalCosts.accesseories" />
                    </mat-form-field>


                    <mat-form-field appearance="standard">
                        <mat-label>Total</mat-label>
                        <input matInput readonly [ngModel]="inversion.additionalCosts.accesseoriesTotal" />
                    </mat-form-field>
                </div>

                <div>
                    <mat-form-field appearance="standard">
                        <mat-label>Renovation Management</mat-label>
                        <input matInput [(ngModel)]="inversion.additionalCosts.renovationManagement" percentage />
                    </mat-form-field>


                    <mat-form-field appearance="standard">
                        <mat-label>Total</mat-label>
                        <input matInput readonly [ngModel]="inversion.additionalCosts.renovationManagementTotal" />
                    </mat-form-field>
                </div>

                <mat-card-footer>
                    <label class="total-label">Total</label>
                    <label>{{inversion.additionalCosts.renovationTotal  | number:'1.0-0'}}</label>
                </mat-card-footer>

            </mat-card>

            <mat-card>
                <mat-card-header>Other Expenses</mat-card-header>

                <mat-form-field appearance="standard">
                    <mat-label>Unpredicted (Est.)</mat-label>
                    <input matInput [(ngModel)]="inversion.additionalCosts.unpredicted" />
                </mat-form-field>
            </mat-card>
        </mat-expansion-panel>
    </mat-card>

    <mat-card>
        <mat-card-header>Financing</mat-card-header>

        <div>
            <mat-form-field appearance="standard">
                <mat-label>Financing</mat-label>
                <input matInput [(ngModel)]="inversion.financing" required appThousands />
            </mat-form-field>

            <mat-form-field appearance="standard">
                <mat-label>Financing %</mat-label>

                <input matInput [ngModel]="inversion.financing / inversion.propertyCost"
                    (ngModelChange)="inversion.financing = $event * inversion.propertyCost" type="number" step="0.01"
                    percentage />
            </mat-form-field>
        </div>

        <div>
            <mat-form-field appearance="standard">
                <mat-label>Rate (%)</mat-label>
                <input matInput [(ngModel)]="inversion.financingRate" type="number" step="0.01" percentage />
            </mat-form-field>
        </div>

        <div>
            <mat-form-field appearance="standard">
                <mat-label>Years</mat-label>
                <input matInput [(ngModel)]="inversion.financingNPER" />
            </mat-form-field>
        </div>

        <mat-card-footer>
            <div>
                <label class="total-label">PMT</label>
                <label>{{inversion.PMT  | abs | number:'1.0-0'}}</label>
            </div>

            <div>
                <label class="total-label">Self Captial</label>
                <label>{{inversion.selfCapital | number:'1.0-0'}}</label>
            </div>

        </mat-card-footer>
    </mat-card>

    <mat-card>
        <mat-card-header>Rent</mat-card-header>

        <div>
            <mat-form-field appearance="standard">
                <mat-label>Daily Rent</mat-label>
                <input matInput [(ngModel)]="inversion.rent.dailyRent" />
            </mat-form-field>
        </div>
        <div>
            <mat-form-field appearance="standard">
                <mat-label>Yearly Change (%)</mat-label>
                <input matInput [(ngModel)]="inversion.rent.yearlyChange" type="number" percentage />
            </mat-form-field>
        </div>
        <div>
            <mat-form-field appearance="standard">
                <mat-label>Occupancy (%)</mat-label>
                <input matInput [(ngModel)]="inversion.rent.occupancyPercentage" type="number" percentage />
            </mat-form-field>
        </div>
        <div>
            <mat-form-field appearance="standard">
                <mat-label>Management Fees (%)</mat-label>
                <input matInput [(ngModel)]="inversion.rent.managementFees" type="number" percentage />
            </mat-form-field>
        </div>

        <mat-card-footer>
            <label class="total-label">Monthly Rent</label>
            <label>{{inversion.rent.monthlyIncome | number:'1.0-0'}}</label>
        </mat-card-footer>
    </mat-card>

    <mat-card>
        <mat-card-header>Exit</mat-card-header>

        <div>
            <mat-form-field appearance="standard">
                <mat-label>Investment Period</mat-label>
                <input matInput [(ngModel)]="inversion.investmentPeriod" />
            </mat-form-field>
        </div>

        <div>
            <mat-form-field appearance="standard">
                <mat-label>Current Property Value</mat-label>
                <input matInput [(ngModel)]="inversion.currentPropertyValue" appThousands />
            </mat-form-field>
        </div>

        <div>
            <mat-form-field appearance="standard">
                <mat-label>Yearly Value Change (%)</mat-label>
                <input matInput [(ngModel)]="inversion.propertyValueChange" type="number" step="0.01" percentage />
            </mat-form-field>
        </div>

    </mat-card>

    <div>
        <mat-card>
            <mat-card-header>Total Cashflow</mat-card-header>

            <div>
                <label class="total-label">Total Rent</label>
                <label>{{inversion.totalRent | number:'1.0-0'}}</label>
            </div>

            <div>
                <label class="total-label">Financial Expences</label>
                <label>{{inversion.financialExpenses | abs | number:'1.0-0'}}</label>
            </div>

            <div>
                <label class="total-label">Total Income</label>
                <label>{{inversion.totalCachflowIncome | number:'1.0-0'}}</label>
            </div>
        </mat-card>

        <mat-card>
            <mat-card-header>Balance</mat-card-header>

            <div>
                <label class="total-label">Future Property Value:</label>
                <span>{{inversion.futurePropertyValue | number:'1.0-0'}}</span>
            </div>

            <div>
                <label class="total-label">Loan Balance:</label>
                <span>{{inversion.loanExitBalance | abs | number:'1.0-0'}}</span>
            </div>

            <div>
                <label class="total-label">Total</label>
                <span>{{inversion.totalExitBalance | number:'1.0-0'}}</span>
            </div>
        </mat-card>

        <mat-card>
            <mat-card-header>Gain</mat-card-header>

            <div>
                <label class="total-label">Nominal Gain</label>
                <span>{{inversion.nominalGain | number:'1.0-0'}}</span>
            </div>

            <div>
                <label class="total-label">IRR</label>
                <span>{{inversion.IRR | percent:'1.2'}}</span>
            </div>
        </mat-card>
    </div>
</main>